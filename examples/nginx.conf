# Example Nginx configuration for precompressed static files
# Used with Aurynx\HttpCompression
# Serve precompressed static assets with gzip, brotli, or zstd
http {
    gzip_static  on;   # Enables .gz
    brotli_static on;  # Enables .br (requires ngx_brotli)
    zstd_static  on;   # Optional, with ngx_zstd

    server {
        root /var/www/html/public;

        # Try cache first, then fallback to PHP
        location / {
            # Serve precompressed or cached static content first
            try_files
                /cache/static$uri.html
                /cache/static$uri/index.html
                $uri
                $uri/
                /index.php?$query_string;
        }

        location ~ \.php$ {
            include fastcgi_params;
            fastcgi_pass unix:/run/php/php8.4-fpm.sock;
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        }
    }
}
